package des;

public class SBox extends BitBlock {
    final byte[][] sbox;

    public SBox(byte[][] sblock) {
        checkSize(NumberOfBytes.SBOX.length, sblock.length);
        checkSize(NumberOfBytes.SBOX.width, sblock[0].length);
        this.sbox = sblock;
    }

    public byte getSubstitution(byte sixBitInput) {
        byte middle = getMiddleOfSix(sixBitInput);
        byte bounds = getBoundsOfSix(sixBitInput);
        return sbox[middle][bounds];
    }

    public static byte getBoundsOfSix(byte sixBitInput) {
        int rightBound = (maskBits(sixBitInput, BitMask.LASTBIT));
        int leftBoundShifted = maskBits(sixBitInput, BitMask.THIRDBIT) >> 4;
        return int2byte(rightBound | leftBoundShifted);
    }

    public static byte getMiddleOfSix(byte sixBitInput) {
        return int2byte(maskBits(sixBitInput, BitMask.FOURTOSEVENBIT) >> 1);
    }

    public static final byte[][] s1box = new byte[][]{
            {0b1110, 0b0000, 0b0100, 0b1111},
            {0b0100, 0b1111, 0b0001, 0b1100},
            {0b1101, 0b0111, 0b1110, 0b1000},
            {0b0001, 0b0100, 0b1000, 0b0010},
            {0b0010, 0b1110, 0b1101, 0b0100},
            {0b1111, 0b0010, 0b0110, 0b1001},
            {0b1001, 0b1101, 0b0010, 0b0001},
            {0b1000, 0b0001, 0b1011, 0b0111},
            {0b0011, 0b1010, 0b1111, 0b0101},
            {0b1010, 0b0110, 0b1100, 0b1011},
            {0b0110, 0b1100, 0b1001, 0b0011},
            {0b1100, 0b1011, 0b0111, 0b1110},
            {0b0101, 0b1001, 0b0011, 0b1010},
            {0b1001, 0b0101, 0b1010, 0b0000},
            {0b0000, 0b0011, 0b0101, 0b0110},
            {0b0111, 0b1000, 0b0000, 0b1101}};
    public static final byte[][] s2box = new byte[][]{
            {0b1111, 0b0011, 0b0000, 0b1101},
            {0b0001, 0b1101, 0b1110, 0b1000},
            {0b1000, 0b0100, 0b0111, 0b1010},
            {0b1110, 0b0111, 0b1011, 0b0001},
            {0b0110, 0b1111, 0b1010, 0b0011},
            {0b1011, 0b0010, 0b0100, 0b1111},
            {0b0011, 0b1000, 0b1101, 0b0100},
            {0b0100, 0b1110, 0b0001, 0b0010},
            {0b1001, 0b1100, 0b0101, 0b1011},
            {0b0111, 0b0000, 0b1000, 0b0110},
            {0b0010, 0b0001, 0b1100, 0b0111},
            {0b1101, 0b1010, 0b0110, 0b1100},
            {0b1100, 0b0110, 0b1001, 0b0000},
            {0b0000, 0b1001, 0b0011, 0b0101},
            {0b0101, 0b1011, 0b0010, 0b1110},
            {0b1010, 0b0101, 0b1111, 0b1001}};
    public static final byte[][] s3box = new byte[][]{
            {0b1010, 0b1101, 0b1101, 0b0001},
            {0b0000, 0b0111, 0b0110, 0b1010},
            {0b1001, 0b0000, 0b0100, 0b1101},
            {0b1110, 0b1001, 0b1001, 0b0000},
            {0b0110, 0b0011, 0b1000, 0b0110},
            {0b0011, 0b0100, 0b1111, 0b1001},
            {0b1111, 0b0110, 0b0011, 0b1000},
            {0b0101, 0b1010, 0b0000, 0b0111},
            {0b0001, 0b0010, 0b1011, 0b0100},
            {0b1101, 0b1000, 0b0001, 0b1111},
            {0b1100, 0b0101, 0b0010, 0b1110},
            {0b0111, 0b1110, 0b1100, 0b0011},
            {0b1011, 0b1100, 0b0101, 0b1011},
            {0b0100, 0b1011, 0b1010, 0b0101},
            {0b0010, 0b1111, 0b1110, 0b0010},
            {0b1000, 0b0001, 0b0111, 0b1100}};
    public static final byte[][] s4box = new byte[][]{
            {0b0111, 0b1101, 0b1010, 0b0011},
            {0b1101, 0b1000, 0b0110, 0b1111},
            {0b1110, 0b1011, 0b1001, 0b0000},
            {0b0011, 0b0101, 0b0000, 0b0110},
            {0b0000, 0b0110, 0b1100, 0b1010},
            {0b0110, 0b1111, 0b1011, 0b0001},
            {0b1001, 0b0000, 0b0111, 0b1101},
            {0b1010, 0b0011, 0b1101, 0b1000},
            {0b0001, 0b0100, 0b1111, 0b1001},
            {0b0010, 0b0111, 0b0001, 0b0100},
            {0b1000, 0b0010, 0b0011, 0b0101},
            {0b0101, 0b1100, 0b1110, 0b1011},
            {0b1011, 0b0001, 0b0101, 0b1100},
            {0b1100, 0b1010, 0b0010, 0b0111},
            {0b0100, 0b1110, 0b1000, 0b0010},
            {0b1111, 0b1001, 0b0100, 0b1110}};
    public static final byte[][] s5box = new byte[][]{
            {0b0010, 0b1110, 0b0100, 0b1011},
            {0b1100, 0b1011, 0b0010, 0b1000},
            {0b0100, 0b0010, 0b0001, 0b1100},
            {0b0001, 0b1100, 0b1011, 0b0111},
            {0b0111, 0b0100, 0b1010, 0b0001},
            {0b1010, 0b0111, 0b1101, 0b1110},
            {0b1011, 0b1101, 0b0111, 0b0010},
            {0b0110, 0b0001, 0b1000, 0b1101},
            {0b1000, 0b0101, 0b1111, 0b0110},
            {0b0101, 0b0000, 0b1001, 0b1111},
            {0b0011, 0b1111, 0b1100, 0b0000},
            {0b1111, 0b1010, 0b0101, 0b1001},
            {0b1101, 0b0011, 0b0110, 0b1010},
            {0b0000, 0b1001, 0b0011, 0b0100},
            {0b1110, 0b1000, 0b0000, 0b0101},
            {0b1001, 0b0110, 0b1110, 0b0011}};
    public static final byte[][] s6box = new byte[][]{
            {0b1100, 0b1010, 0b1001, 0b0100},
            {0b0001, 0b1111, 0b1110, 0b0011},
            {0b1010, 0b0100, 0b1111, 0b0010},
            {0b1111, 0b0010, 0b0101, 0b1100},
            {0b1001, 0b0111, 0b0010, 0b0010},
            {0b0010, 0b1100, 0b1000, 0b0101},
            {0b0110, 0b1001, 0b1100, 0b1111},
            {0b1000, 0b0101, 0b0011, 0b1010},
            {0b0000, 0b0110, 0b0111, 0b1011},
            {0b1101, 0b0001, 0b0000, 0b1110},
            {0b0011, 0b1101, 0b0100, 0b0001},
            {0b0100, 0b1110, 0b1010, 0b0111},
            {0b1110, 0b0000, 0b0001, 0b0110},
            {0b0111, 0b1011, 0b1101, 0b0000},
            {0b0101, 0b0011, 0b1011, 0b1000},
            {0b1011, 0b1000, 0b0110, 0b1101}};
    public static final byte[][] s7box = new byte[][]{
            {0b0100, 0b1101, 0b0001, 0b0110},
            {0b1011, 0b0000, 0b0100, 0b1011},
            {0b0010, 0b1011, 0b1011, 0b1101},
            {0b1110, 0b0111, 0b1101, 0b1000},
            {0b1111, 0b0100, 0b1100, 0b0001},
            {0b0000, 0b1001, 0b0011, 0b0100},
            {0b1000, 0b0001, 0b0111, 0b1010},
            {0b1101, 0b1010, 0b1110, 0b0111},
            {0b0011, 0b1110, 0b1010, 0b1001},
            {0b1100, 0b0011, 0b1111, 0b0101},
            {0b1001, 0b0101, 0b0110, 0b0000},
            {0b0111, 0b1100, 0b1000, 0b1111},
            {0b0101, 0b0010, 0b0000, 0b1110},
            {0b1010, 0b1111, 0b0101, 0b0010},
            {0b0110, 0b1000, 0b1001, 0b0011},
            {0b0001, 0b0110, 0b0010, 0b1100}};
    public static final byte[][] s8box = new byte[][]{
            {0b1101, 0b0001, 0b0111, 0b0010},
            {0b0010, 0b1111, 0b1011, 0b0001},
            {0b1000, 0b1101, 0b0100, 0b1110},
            {0b0100, 0b1000, 0b0001, 0b0111},
            {0b0110, 0b1010, 0b1001, 0b0100},
            {0b1111, 0b0011, 0b1100, 0b1010},
            {0b1011, 0b0111, 0b1110, 0b1000},
            {0b0001, 0b0100, 0b0010, 0b1101},
            {0b1010, 0b1100, 0b0000, 0b1111},
            {0b1001, 0b0101, 0b0110, 0b1100},
            {0b0011, 0b0110, 0b1010, 0b1001},
            {0b1110, 0b1011, 0b1101, 0b0000},
            {0b0101, 0b0000, 0b1111, 0b0011},
            {0b0000, 0b1110, 0b0011, 0b0101},
            {0b1100, 0b1001, 0b0101, 0b0110},
            {0b0111, 0b0010, 0b1000, 0b1011}};
}
