package des;

public class SBox extends BitBlock {
    final byte[][] sbox;

    public SBox(byte[][] sblock) {
        checkSize(NumberOfBytes.SBOX.length, sblock.length);
        checkSize(NumberOfBytes.SBOX.width, sblock[0].length);
        this.sbox = sblock;
    }

    public byte getSubstitution(byte sixBitInput) {
        byte middle = getMiddleOfSix(sixBitInput);
        byte bounds = getBoundsOfSix(sixBitInput);
        return sbox[middle][bounds];
    }

    public static byte getBoundsOfSix(byte sixBitInput) {
        byte rightBound = (maskBits(sixBitInput, BitMask.LASTBIT));
        byte leftBoundShifted = (byte) (maskBits(sixBitInput, BitMask.THIRDBIT) >> 4);
        return (byte) (rightBound | leftBoundShifted);
    }

    public static byte getMiddleOfSix(byte sixBitInput) {
        return (byte) (maskBits(sixBitInput, BitMask.FOURTOSEVENBIT) >> 1);
    }

    public static final byte[][] s1box = new byte[][]{
            {0b00001110, 0b00000000, 0b00000100, 0b00001111},
            {0b00000100, 0b00001111, 0b00000001, 0b00001100},
            {0b00001101, 0b00000111, 0b00001110, 0b00001000},
            {0b00000001, 0b00000100, 0b00001000, 0b00000010},
            {0b00000010, 0b00001110, 0b00001101, 0b00000100},
            {0b00001111, 0b00000010, 0b00000110, 0b00001001},
            {0b00001001, 0b00001101, 0b00000010, 0b00000001},
            {0b00001000, 0b00000001, 0b00001011, 0b00000111},
            {0b00000011, 0b00001010, 0b00001111, 0b00000101},
            {0b00001010, 0b00000110, 0b00001100, 0b00001011},
            {0b00000110, 0b00001100, 0b00001001, 0b00000011},
            {0b00001100, 0b00001011, 0b00000111, 0b00001110},
            {0b00000101, 0b00001001, 0b00000011, 0b00001010},
            {0b00001001, 0b00000101, 0b00001010, 0b00000000},
            {0b00000000, 0b00000011, 0b00000101, 0b00000110},
            {0b00000111, 0b00001000, 0b00000000, 0b00001101}};
    public static final byte[][] s2box = new byte[][]{
            {0b00001111, 0b00000011, 0b00000000, 0b00001101},
            {0b00000001, 0b00001101, 0b00001110, 0b00001000},
            {0b00001000, 0b00000100, 0b00000111, 0b00001010},
            {0b00001110, 0b00000111, 0b00001011, 0b00000001},
            {0b00000110, 0b00001111, 0b00001010, 0b00000011},
            {0b00001011, 0b00000010, 0b00000100, 0b00001111},
            {0b00000011, 0b00001000, 0b00001101, 0b00000100},
            {0b00000100, 0b00001110, 0b00000001, 0b00000010},
            {0b00001001, 0b00001100, 0b00000101, 0b00001011},
            {0b00000111, 0b00000000, 0b00001000, 0b00000110},
            {0b00000010, 0b00000001, 0b00001100, 0b00000111},
            {0b00001101, 0b00001010, 0b00000110, 0b00001100},
            {0b00001100, 0b00000110, 0b00001001, 0b00000000},
            {0b00000000, 0b00001001, 0b00000011, 0b00000101},
            {0b00000101, 0b00001011, 0b00000010, 0b00001110},
            {0b00001010, 0b00000101, 0b00001111, 0b00001001}};
    public static final byte[][] s3box = new byte[][]{
            {0b00001010, 0b00001101, 0b00001101, 0b00000001},
            {0b00000000, 0b00000111, 0b00000110, 0b00001010},
            {0b00001001, 0b00000000, 0b00000100, 0b00001101},
            {0b00001110, 0b00001001, 0b00001001, 0b00000000},
            {0b00000110, 0b00000011, 0b00001000, 0b00000110},
            {0b00000011, 0b00000100, 0b00001111, 0b00001001},
            {0b00001111, 0b00000110, 0b00000011, 0b00001000},
            {0b00000101, 0b00001010, 0b00000000, 0b00000111},
            {0b00000001, 0b00000010, 0b00001011, 0b00000100},
            {0b00001101, 0b00001000, 0b00000001, 0b00001111},
            {0b00001100, 0b00000101, 0b00000010, 0b00001110},
            {0b00000111, 0b00001110, 0b00001100, 0b00000011},
            {0b00001011, 0b00001100, 0b00000101, 0b00001011},
            {0b00000100, 0b00001011, 0b00001010, 0b00000101},
            {0b00000010, 0b00001111, 0b00001110, 0b00000010},
            {0b00001000, 0b00000001, 0b00000111, 0b00001100}};
    public static final byte[][] s4box = new byte[][]{
            {0b00000111, 0b00001101, 0b00001010, 0b00000011},
            {0b00001101, 0b00001000, 0b00000110, 0b00001111},
            {0b00001110, 0b00001011, 0b00001001, 0b00000000},
            {0b00000011, 0b00000101, 0b00000000, 0b00000110},
            {0b00000000, 0b00000110, 0b00001100, 0b00001010},
            {0b00000110, 0b00001111, 0b00001011, 0b00000001},
            {0b00001001, 0b00000000, 0b00000111, 0b00001101},
            {0b00001010, 0b00000011, 0b00001101, 0b00001000},
            {0b00000001, 0b00000100, 0b00001111, 0b00001001},
            {0b00000010, 0b00000111, 0b00000001, 0b00000100},
            {0b00001000, 0b00000010, 0b00000011, 0b00000101},
            {0b00000101, 0b00001100, 0b00001110, 0b00001011},
            {0b00001011, 0b00000001, 0b00000101, 0b00001100},
            {0b00001100, 0b00001010, 0b00000010, 0b00000111},
            {0b00000100, 0b00001110, 0b00001000, 0b00000010},
            {0b00001111, 0b00001001, 0b00000100, 0b00001110}};
    public static final byte[][] s5box = new byte[][]{
            {0b00000010, 0b00001110, 0b00000100, 0b00001011},
            {0b00001100, 0b00001011, 0b00000010, 0b00001000},
            {0b00000100, 0b00000010, 0b00000001, 0b00001100},
            {0b00000001, 0b00001100, 0b00001011, 0b00000111},
            {0b00000111, 0b00000100, 0b00001010, 0b00000001},
            {0b00001010, 0b00000111, 0b00001101, 0b00001110},
            {0b00001011, 0b00001101, 0b00000111, 0b00000010},
            {0b00000110, 0b00000001, 0b00001000, 0b00001101},
            {0b00001000, 0b00000101, 0b00001111, 0b00000110},
            {0b00000101, 0b00000000, 0b00001001, 0b00001111},
            {0b00000011, 0b00001111, 0b00001100, 0b00000000},
            {0b00001111, 0b00001010, 0b00000101, 0b00001001},
            {0b00001101, 0b00000011, 0b00000110, 0b00001010},
            {0b00000000, 0b00001001, 0b00000011, 0b00000100},
            {0b00001110, 0b00001000, 0b00000000, 0b00000101},
            {0b00001001, 0b00000110, 0b00001110, 0b00000011}};
    public static final byte[][] s6box = new byte[][]{
            {0b00001100, 0b00001010, 0b00001001, 0b00000100},
            {0b00000001, 0b00001111, 0b00001110, 0b00000011},
            {0b00001010, 0b00000100, 0b00001111, 0b00000010},
            {0b00001111, 0b00000010, 0b00000101, 0b00001100},
            {0b00001001, 0b00000111, 0b00000010, 0b00000010},
            {0b00000010, 0b00001100, 0b00001000, 0b00000101},
            {0b00000110, 0b00001001, 0b00001100, 0b00001111},
            {0b00001000, 0b00000101, 0b00000011, 0b00001010},
            {0b00000000, 0b00000110, 0b00000111, 0b00001011},
            {0b00001101, 0b00000001, 0b00000000, 0b00001110},
            {0b00000011, 0b00001101, 0b00000100, 0b00000001},
            {0b00000100, 0b00001110, 0b00001010, 0b00000111},
            {0b00001110, 0b00000000, 0b00000001, 0b00000110},
            {0b00000111, 0b00001011, 0b00001101, 0b00000000},
            {0b00000101, 0b00000011, 0b00001011, 0b00001000},
            {0b00001011, 0b00001000, 0b00000110, 0b00001101}};
    public static final byte[][] s7box = new byte[][]{
            {0b00000100, 0b00001101, 0b00000001, 0b00000110},
            {0b00001011, 0b00000000, 0b00000100, 0b00001011},
            {0b00000010, 0b00001011, 0b00001011, 0b00001101},
            {0b00001110, 0b00000111, 0b00001101, 0b00001000},
            {0b00001111, 0b00000100, 0b00001100, 0b00000001},
            {0b00000000, 0b00001001, 0b00000011, 0b00000100},
            {0b00001000, 0b00000001, 0b00000111, 0b00001010},
            {0b00001101, 0b00001010, 0b00001110, 0b00000111},
            {0b00000011, 0b00001110, 0b00001010, 0b00001001},
            {0b00001100, 0b00000011, 0b00001111, 0b00000101},
            {0b00001001, 0b00000101, 0b00000110, 0b00000000},
            {0b00000111, 0b00001100, 0b00001000, 0b00001111},
            {0b00000101, 0b00000010, 0b00000000, 0b00001110},
            {0b00001010, 0b00001111, 0b00000101, 0b00000010},
            {0b00000110, 0b00001000, 0b00001001, 0b00000011},
            {0b00000001, 0b00000110, 0b00000010, 0b00001100}};
    public static final byte[][] s8box = new byte[][]{
            {0b00001101, 0b00000001, 0b00000111, 0b00000010},
            {0b00000010, 0b00001111, 0b00001011, 0b00000001},
            {0b00001000, 0b00001101, 0b00000100, 0b00001110},
            {0b00000100, 0b00001000, 0b00000001, 0b00000111},
            {0b00000110, 0b00001010, 0b00001001, 0b00000100},
            {0b00001111, 0b00000011, 0b00001100, 0b00001010},
            {0b00001011, 0b00000111, 0b00001110, 0b00001000},
            {0b00000001, 0b00000100, 0b00000010, 0b00001101},
            {0b00001010, 0b00001100, 0b00000000, 0b00001111},
            {0b00001001, 0b00000101, 0b00000110, 0b00001100},
            {0b00000011, 0b00000110, 0b00001010, 0b00001001},
            {0b00001110, 0b00001011, 0b00001101, 0b00000000},
            {0b00000101, 0b00000000, 0b00001111, 0b00000011},
            {0b00000000, 0b00001110, 0b00000011, 0b00000101},
            {0b00001100, 0b00001001, 0b00000101, 0b00000110},
            {0b00000111, 0b00000010, 0b00001000, 0b00001011}};
}
